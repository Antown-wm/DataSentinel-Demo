<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>DataOps 血缘可视化</title>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
</head>
<body>
    <h1 style="text-align:center">企业级数据血缘分析系统</h1>
    <div id="main" style="width: 100%;height:600px;border:1px solid #ccc;"></div>
    <script>
        var chartDom = document.getElementById('main');
        var myChart = echarts.init(chartDom);
        
        // 自动获取当前IP，指向 30080 接口
        const API_URL = "http://" + window.location.hostname + ":30080/graph/data";

        fetch(API_URL)
            .then(res => res.json())
            .then(data => {
                myChart.setOption({
                    title: { text: '表级依赖拓扑图' },
                    tooltip: {},
                    series: [{
                        type: 'graph',
                        layout: 'force',
                        data: data.nodes,
                        links: data.links,
                        roam: true,
                        label: { show: true, position: 'right' },
                        edgeSymbol: ['circle', 'arrow'],
                        edgeSymbolSize: [4, 10],
                        force: { repulsion: 1000, edgeLength: 100 }
                    }]
                });
            });
    </script>
</body>
</html>
